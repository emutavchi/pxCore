'use strict';var isV8="undefined"!=typeof _isV8,WS=null;WS=isV8?require("ws"):require("ws/lib/WebSocket");function socketClosed(){arguments[0].clearConnection(this),this.removeListener("close",socketClosed)}function WebSocketManager(){this.connections=[]}WebSocketManager.prototype.clearConnection=function(a){if(this.connections!=null&&0<this.connections.length){var b=this.connections.indexOf(a);-1!=b&&(delete this.connections[b],this.connections.splice(b,1))}},WebSocketManager.prototype.clearConnections=function(){for(var a=this.connections.length,b=0;b<a;b++)null!=this.connections[b]&&null!=this.connections[b]&&(this.connections[b].close(),this.connections[b].closeimmediate(),null!=this.connections[b]&&null!=this.connections[b]&&(this.connections[b].removeAllListeners("open"),this.connections[b].removeAllListeners("error"),this.connections[b].removeAllListeners("message"),this.connections[b].removeAllListeners("close"),delete this.connections[b]));this.connections.splice(0,this.connections.length),delete this.connections,this.connections=null},WebSocketManager.prototype.WebSocket=function(a,b,c){var d=new WS(a,b,c);return"function"==typeof fn&&d.on("open",fn),this.connections.push(d),d.on("close",socketClosed.bind(d,this)),d},module.exports=WebSocketManager;